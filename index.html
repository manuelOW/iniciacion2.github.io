<!DOCTYPE html>
<html>
  <head>
    <title>Estilo de pintor aleatorio con DeepAI Image API</title>
  </head>
  <body>
    <h1>Estilo de pintor aleatorio con DeepAI Image API</h1>
    <form>
      <label for="imagen">Cargar imagen:</label>
      <input type="file" id="imagen" name="imagen" accept="image/*">
      <br>
      <label for="estilo">Seleccionar estilo:</label>
      <select id="estilo" name="estilo">
        <option value="vangogh">Van Gogh</option>
        <option value="picasso">Picasso</option>
        <option value="velazquez">Vel√°zquez</option>
      </select>
      <br>
      <button type="button" onclick="procesarImagen()">Procesar imagen</button>
    </form>
    <div id="resultado"></div>

    <script>
      async function procesarImagen() {
        const archivo = document.getElementById('imagen').files[0];
        if (!archivo) {
          alert('Por favor, seleccione una imagen para procesar.');
          return;
        }

        const lector = new FileReader();

        lector.onload = async () => {
          const imagenBase64 = lector.result.split(',')[1];

          const estilo = document.getElementById('estilo').value;

          const response = await fetch('https://api.deepai.org/api/neural-style', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/x-www-form-urlencoded',
              'api-key': 'fe10a5a6-bccd-410e-a138-c43f99b62ce5',
            },
            body: new URLSearchParams({
              content: imagenBase64,
              style: estilo,
            }),
          });

          const data = await response.json();

          const imagenResultado = new Image();
          imagenResultado.src = data.output_url;

          document.getElementById('resultado').innerHTML = '';

          const enlaceDescarga = document.createElement('a');
          enlaceDescarga.download = 'imagen-procesada.jpg';
          enlaceDescarga.href = imagenResultado.src;
          enlaceDescarga.innerHTML = 'Descargar imagen';

          document.getElementById('resultado').appendChild(imagenResultado);
          document.getElementById('resultado').appendChild(document.createElement('br'));
          document.getElementById('resultado').appendChild(enlaceDescarga);
        };

        lector.readAsDataURL(archivo);
      }
    </script>
  </body>
</html>
